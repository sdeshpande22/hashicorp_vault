# Define variables
$pscpPath = "C:\path\to\pscp.exe"  # Replace with the actual path to pscp.exe
$localFilePath = "C:\local\file.txt"  # Replace with the path to your local file
$admHostname = "adm-server"  # Replace with your Citrix ADM hostname or IP address
$username = "your_username"  # Replace with your ADM username
$remotePath = "/remote/path/"  # Replace with your desired remote path on ADM

# Construct the pscp command
$command = "& `"$pscpPath`" `"$localFilePath`" $username@$admHostname:`"$remotePath`""

# Execute pscp command using Start-Process
Start-Process -FilePath "powershell.exe" -ArgumentList "-NoProfile -ExecutionPolicy Bypass -Command $command" -Wait

#####################################################################################################################################
# Define variables
$pscpPath = "C:\path\to\pscp.exe"  # Replace with the actual path to pscp.exe
$plinkPath = "C:\path\to\plink.exe"  # Replace with the actual path to plink.exe
$localFilePath = "C:\local\file.txt"  # Replace with the path to your local file
$admHostname = "adm-server"  # Replace with your Citrix ADM hostname or IP address
$username = "your_username"  # Replace with your ADM username
$password = "your_password"  # Replace with your ADM password (consider secure handling)
$remotePath = "/remote/path/"  # Replace with your desired remote path on ADM

# Create a script to echo the password and call pscp
$plinkScript = @"
echo y | `$plinkPath -pw `$password $username@$admHostname echo "Logged In"
`$pscpPath -pw `$password `$localFilePath $username@$admHostname:`$remotePath
"@

# Execute the script using PowerShell
Invoke-Expression $plinkScript
