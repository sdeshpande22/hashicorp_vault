pipeline {
    agent any

    parameters {
        choice(name: 'AUTH_METHOD', choices: ['basic_auth', 'token'], description: 'Select the authentication method')
    }

    stages {
        stage('Input Authentication Details') {
            steps {
                script {
                    if (params.AUTH_METHOD == 'basic_auth') {
                        def basicAuthParams = input(
                            id: 'basicAuthInput', message: 'Provide Basic Auth credentials and API URL', parameters: [
                                string(name: 'USERNAME', defaultValue: '', description: 'Enter the username'),
                                password(name: 'PASSWORD', defaultValue: '', description: 'Enter the password'),
                                string(name: 'API_URL', defaultValue: '', description: 'Enter the API URL')
                            ]
                        )
                        echo "Basic Auth selected"
                        echo "Username: ${basicAuthParams.USERNAME}"
                        echo "API URL: ${basicAuthParams.API_URL}"
                        // Store the credentials in environment variables or handle them securely as needed
                        env.USERNAME = basicAuthParams.USERNAME
                        env.PASSWORD = basicAuthParams.PASSWORD
                        env.API_URL = basicAuthParams.API_URL

                    } else if (params.AUTH_METHOD == 'token') {
                        def tokenAuthParams = input(
                            id: 'tokenAuthInput', message: 'Provide Token and API URL', parameters: [
                                string(name: 'TOKEN', defaultValue: '', description: 'Enter the token'),
                                string(name: 'API_URL', defaultValue: '', description: 'Enter the API URL')
                            ]
                        )
                        echo "Token Auth selected"
                        echo "Token: ${tokenAuthParams.TOKEN}"
                        echo "API URL: ${tokenAuthParams.API_URL}"
                        // Store the credentials in environment variables or handle them securely as needed
                        env.TOKEN = tokenAuthParams.TOKEN
                        env.API_URL = tokenAuthParams.API_URL
                    }
                }
            }
        }
        stage('Use Authentication Details') {
            steps {
                script {
                    if (params.AUTH_METHOD == 'basic_auth') {
                        echo "Using Basic Auth with API URL: ${env.API_URL}"
                        // Add steps to use USERNAME, PASSWORD, and API_URL
                    } else if (params.AUTH_METHOD == 'token') {
                        echo "Using Token Auth with API URL: ${env.API_URL}"
                        // Add steps to use TOKEN and API_URL
                    }
                }
            }
        }
    }
}
