# Set the Vault address and token
$vaultAddress = "https://your-vault-address:8200"
$vaultToken = "your-token"

# Set the secret ID you want to revoke
$secretID = "your-secret-id"

# Create headers with the Vault token
$headers = @{
    "X-Vault-Token" = $vaultToken
}

# Construct the URL for revoking the secret ID
$url = "$vaultAddress/v1/auth/token/revoke-id/$secretID"

# Revoke the secret ID
$response = Invoke-RestMethod -Uri $url -Method Post -Headers $headers

# Check if the revocation was successful
if ($response.data.revoke_secret_id) {
    Write-Host "Secret ID revoked successfully."
} else {
    Write-Host "Failed to revoke secret ID."
}
