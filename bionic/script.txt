let selectedOption = "text";

function selectOption(option) {
    selectedOption = option;

    document.getElementById("inputText").style.display = "none";
    document.getElementById("inputUrl").style.display = "none";
    document.getElementById("inputFile").style.display = "none";

    if (option === "text") {
        document.getElementById("inputText").style.display = "block";
    } else if (option === "url") {
        document.getElementById("inputUrl").style.display = "block";
    } else if (option === "upload") {
        document.getElementById("inputFile").style.display = "block";
    }
}

async function showSummary() {
    if (selectedOption === "text") {
        await handleTextInput();
    } else if (selectedOption === "url") {
        await handleUrlInput();
    } else if (selectedOption === "upload") {
        await handleFileUpload();
    }
}

async function summarizeText() {
    const text = document.getElementById("inputText").value;
    const formData = new FormData();
    formData.append("text", text);

    try {
        const response = await fetch("/summarize", {
            method: "POST",
            body: formData
        });
        const data = await response.json();
        displaySummary(data.summary);
    } catch (error) {
        console.error("Error summarizing text:", error);
    }
}

function displaySummary(summary) {
    const summaryList = document.getElementById("summaryOutput");
    summaryList.innerHTML = "";

    summary.forEach(item => {
        const li = document.createElement("li");
        li.textContent = item;
        summaryList.appendChild(li);
    });
}

async function handleTextInput() {
    const text = document.getElementById("inputText").value;
    const formData = new FormData();
    formData.append("text", text);

    try {
        const response = await fetch("/convert", {
            method: "POST",
            body: formData
        });
        const data = await response.json();
        document.getElementById("bionicOutput").innerHTML = data.bionic_text;
    } catch (error) {
        console.error("Error processing text input:", error);
    }
}

async function handleUrlInput() {
    const url = document.getElementById("inputUrl").value;
    const formData = new FormData();
    formData.append("url", url);

    try {
        const response = await fetch("/url", {
            method: "POST",
            body: formData
        });
        const data = await response.json();
        document.getElementById("bionicOutput").innerHTML = data.bionic_text;
    } catch (error) {
        console.error("Error processing URL input:", error);
    }
}

async function handleFileUpload() {
    const fileInput = document.getElementById("inputFile");
    const formData = new FormData();
    
    if (fileInput.files.length === 0) {
        alert("Please select a file to upload.");
        return;
    }

    formData.append("file", fileInput.files[0]);

    try {
        const response = await fetch("/upload", {
            method: "POST",
            body: formData
        });
        const data = await response.json();
        document.getElementById("bionicOutput").innerHTML = data.bionic_text;
    } catch (error) {
        console.error("Error processing file upload:", error);
    }
}
