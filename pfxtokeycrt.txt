# Variables for file paths and passwords
$opensslPath = "C:\path\to\openssl.exe"  # Full path to openssl.exe
$pfxFilePath = "C:\path\to\yourfile.pfx"
$keyFilePath = "C:\path\to\yourfile.key"
$crtFilePath = "C:\path\to\yourfile.crt"
$keyPassword = "your_key_password"  # Password to protect the private key

# Extract private key
Start-Process -FilePath $opensslPath -ArgumentList "pkcs12 -in `"$pfxFilePath`" -nocerts -out `"$keyFilePath`" -passout pass:$keyPassword" -NoNewWindow -Wait

# Extract certificate
Start-Process -FilePath $opensslPath -ArgumentList "pkcs12 -in `"$pfxFilePath`" -clcerts -nokeys -out `"$crtFilePath`"" -NoNewWindow -Wait
