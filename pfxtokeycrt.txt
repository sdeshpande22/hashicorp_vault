# Variables for file paths and password
$opensslPath = "C:\path\to\openssl.exe"  # Full path to openssl.exe
$pfxFilePath = "C:\path\to\yourfile.pfx"
$keyFilePath = "C:\path\to\yourfile.key"
$crtFilePath = "C:\path\to\yourfile.crt"
$password = "your_common_password"  # Common password for both PFX and the key

# Extract private key with PFX import password and set a password on the key
Start-Process -FilePath $opensslPath -ArgumentList "pkcs12 -in `"$pfxFilePath`" -nocerts -out `"$keyFilePath`" -passin pass:$password -passout pass:$password" -NoNewWindow -Wait

# Extract certificate with PFX import password
Start-Process -FilePath $opensslPath -ArgumentList "pkcs12 -in `"$pfxFilePath`" -clcerts -nokeys -out `"$crtFilePath`" -passin pass:$password" -NoNewWindow -Wait
